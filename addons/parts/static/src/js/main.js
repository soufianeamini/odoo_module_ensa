// @ts-check
// @ts-ignore
odoo.define(
  "parts.main",
  [],
  /** @param _req {unknown} */ (_req) => {
    console.log("JavaScript initialized!")
    /** @type Map<string, (arg1: HTMLElement) => void>*/
    let inputSetups = new Map()

    /**
		 * @typedef {string} Svg
		 * @typedef {"hood" | "wheel" | "spoiler" | "chassis"} PartType
		 * @type Map<PartType, (hexcolor: string) => Svg>
		 * */
		let images = new Map()
		images.set("hood", "TODO")
		images.set("wheel", "TODO")
		images.set("spoiler", "TODO")
		images.set("chassis", (color) => `<svg
        version="1.1"
        xmlns="http://www.w3.org/2000/svg"
        width="498"
        height="501"
      >
        <path
          d="M0 0 C1.3087207 -0.00169189 2.61744141 -0.00338379 3.96582031 -0.00512695 C12.35088709 0.10088709 12.35088709 0.10088709 14.625 2.375 C14.85205078 5.17236328 14.85205078 5.17236328 14.8203125 8.6953125 C14.81064453 10.58056641 14.81064453 10.58056641 14.80078125 12.50390625 C14.77564453 14.48197266 14.77564453 14.48197266 14.75 16.5 C14.73996983 17.83983721 14.73084404 19.17968152 14.72265625 20.51953125 C14.69902075 23.80486573 14.66607234 27.08984465 14.625 30.375 C15.80715088 30.39481934 16.98930176 30.41463867 18.20727539 30.43505859 C57.82419161 31.1218697 57.82419161 31.1218697 71.125 32.3125 C71.96168213 32.38710449 72.79836426 32.46170898 73.66040039 32.53857422 C82.83686376 33.46274075 91.87294882 35.3462625 100.875 37.3125 C101.62523437 37.46912109 102.37546875 37.62574219 103.1484375 37.78710938 C107.93616531 38.83390352 112.25831043 40.11812288 116.625 42.375 C118.00064382 46.50193147 117.80923809 50.36546343 117.8125 54.6875 C117.82474609 55.52990234 117.83699219 56.37230469 117.84960938 57.24023438 C117.8607437 61.98716699 117.63043424 65.97399585 115.625 70.375 C111.625 73.375 111.625 73.375 108.625 73.375 C109.46181048 80.76315565 110.38619746 88.11282679 111.6484375 95.44140625 C111.82922852 96.50367432 112.01001953 97.56594238 112.19628906 98.66040039 C112.55421719 100.73837202 112.92264482 102.8145745 113.30371094 104.88842773 C115.72519894 119.03399164 114.61900711 132.52922926 112.65905762 146.61605835 C112.05326076 151.00179077 111.49264554 155.39325551 110.93359375 159.78515625 C110.82012604 160.67636673 110.70665833 161.56757721 110.5897522 162.48579407 C107.77791597 184.88085394 106.41327311 207.28121781 105.9699707 229.83886719 C105.76694052 239.85829742 105.27571261 249.81698954 104.5625 259.8125 C104.23765548 264.66593152 103.92659509 269.52007136 103.625 274.375 C103.55265137 275.49181152 103.48030273 276.60862305 103.40576172 277.75927734 C103.22494521 280.83963222 103.10195588 283.91615885 103 287 C102.94062256 287.88872803 102.88124512 288.77745605 102.82006836 289.69311523 C102.77323813 292.17462704 102.80455462 294.03003908 103.625 296.375 C105.57335549 298.13415348 107.44672873 299.25987941 109.79931641 300.41552734 C111.625 301.375 111.625 301.375 112.625 303.375 C112.7246504 306.43088301 112.76476747 309.46344603 112.7578125 312.51953125 C112.75876923 313.44029953 112.75972595 314.36106781 112.76071167 315.30973816 C112.76139359 317.26760933 112.75953847 319.22548275 112.75537109 321.18334961 C112.75008982 324.13726102 112.75528053 327.09101565 112.76171875 330.04492188 C112.77731546 357.81765766 112.77731546 357.81765766 108.75 369.25 C108.4511792 370.12277588 108.1523584 370.99555176 107.84448242 371.89477539 C103.98070235 382.75354521 98.99669576 393.18715207 93.625 403.375 C92.74908203 405.09396484 92.74908203 405.09396484 91.85546875 406.84765625 C86.75132428 412.63116146 77.65458895 413.12100836 70.375 414.375 C69.41899902 414.54233643 68.46299805 414.70967285 67.47802734 414.88208008 C64.52878871 415.39091223 61.57740694 415.88491832 58.625 416.375 C57.30000488 416.60002197 57.30000488 416.60002197 55.94824219 416.82958984 C41.8260838 419.19396937 27.94110224 419.95640052 13.625 420.375 C13.625 430.275 13.625 440.175 13.625 450.375 C8.87408235 452.27536706 7.10040998 452.58100337 2.2265625 452.30859375 C0.9576416 452.23793701 -0.3112793 452.16728027 -1.61865234 452.09448242 C-2.99588167 452.00216537 -4.37299653 451.90812691 -5.75 451.8125 C-6.45118958 451.76654694 -7.15237915 451.72059387 -7.87481689 451.67324829 C-29.73755689 450.20804727 -51.43973037 446.97516797 -72.375 440.375 C-73.60089844 440.05917969 -74.82679688 439.74335938 -76.08984375 439.41796875 C-84.8611713 436.63325477 -89.22437146 429.0884513 -93.375 421.375 C-93.75914062 420.70082031 -94.14328125 420.02664063 -94.5390625 419.33203125 C-95.84867498 417.02907325 -97.11198911 414.70388515 -98.375 412.375 C-98.8685498 411.47950439 -98.8685498 411.47950439 -99.37207031 410.56591797 C-110.73831784 389.90869269 -118.51825085 369.51868981 -118.54296875 345.6875 C-118.54629715 344.5533667 -118.54962555 343.4192334 -118.55305481 342.25073242 C-118.55810923 339.84684655 -118.56046359 337.44295368 -118.56030273 335.0390625 C-118.56245947 331.44258242 -118.58054793 327.84642465 -118.59960938 324.25 C-118.62940936 312.91467377 -118.45315982 301.62010054 -117.61328125 290.3125 C-117.55230759 289.34868408 -117.49133392 288.38486816 -117.42851257 287.3918457 C-117.31368279 286.06672974 -117.31368279 286.06672974 -117.1965332 284.71484375 C-117.1348848 283.94519287 -117.07323639 283.17554199 -117.00971985 282.38256836 C-116.13839419 279.62663465 -114.84356268 278.79496796 -112.375 277.375 C-111.385 277.375 -110.395 277.375 -109.375 277.375 C-109.44138672 276.82602051 -109.50777344 276.27704102 -109.57617188 275.71142578 C-110.55058956 266.54869891 -110.64952746 257.37484858 -110.81945801 248.17044067 C-110.91353079 243.2240215 -111.02916035 238.27808333 -111.140625 233.33203125 C-111.37012439 223.02128192 -111.37012439 223.02128192 -111.43554688 218.35302734 C-111.60679213 206.41552032 -112.61611022 195.1218686 -114.8125 183.375 C-116.73682364 173.06312783 -118.06508398 162.84248025 -118.6875 152.375 C-118.72855865 151.70076996 -118.76961731 151.02653992 -118.81192017 150.33187866 C-119.29129934 142.05751622 -119.39993904 133.8363603 -119.20703125 125.55078125 C-119.19172867 124.72657684 -119.17642609 123.90237244 -119.16065979 123.05319214 C-119.08567268 119.05863842 -118.97215266 115.07439075 -118.7746582 111.08398438 C-118.44880178 101.44880283 -120.17374547 95.49989786 -125.40869141 87.42114258 C-130.65161979 79.2989651 -130.80077416 71.51748047 -130.65625 62.05566406 C-130.62516538 60.01087908 -130.61526837 57.96687295 -130.609375 55.921875 C-130.4635957 30.58198022 -130.4635957 30.58198022 -120.1875 19.6875 C-102.64529102 3.2862477 -78.02590606 3.38887135 -55.22943878 2.17621613 C-53.10303684 2.06131319 -50.97714176 1.93945923 -48.85125732 1.81536865 C-32.5799318 0.86722286 -16.30352246 0.0050692 0 0 Z M1.2265625 33.7421875 C0.12707275 33.82186768 -0.97241699 33.90154785 -2.10522461 33.98364258 C-3.30800049 34.07154053 -4.51077637 34.15943848 -5.75 34.25 C-14.3943799 34.88005044 -23.03068604 35.4289602 -31.69140625 35.77734375 C-53.3910541 36.67557296 -74.0656977 39.09954354 -95.375 43.375 C-96.74678883 52.46310099 -96.74678883 61.28689901 -95.375 70.375 C-93.8368423 70.88569267 -92.29424711 71.38302747 -90.75 71.875 C-89.89148438 72.1534375 -89.03296875 72.431875 -88.1484375 72.71875 C-85.13783999 73.43111673 -82.45780932 73.48348596 -79.375 73.375 C-80.01723504 76.97981752 -80.66440479 80.58373183 -81.3125 84.1875 C-81.49490234 85.21166016 -81.67730469 86.23582031 -81.86523438 87.29101562 C-82.04248047 88.27392578 -82.21972656 89.25683594 -82.40234375 90.26953125 C-82.56468506 91.17550049 -82.72702637 92.08146973 -82.89428711 93.01489258 C-83.375 95.375 -83.375 95.375 -84.375 98.375 C-87.18457169 122.14782185 -84.4481822 146.05415941 -81.04779053 169.58584595 C-80.60271296 172.67639929 -80.16988244 175.76865043 -79.73590088 178.86077881 C-79.48817034 180.58659716 -79.23197984 182.31121593 -78.96868896 184.034729 C-76.33977566 201.29345556 -76.04280617 218.19018457 -76.25 235.625 C-76.29696988 240.79683411 -76.33500946 245.96867855 -76.3671875 251.140625 C-76.37541534 252.37500809 -76.38364319 253.60939117 -76.39212036 254.88117981 C-76.44889507 269.00936978 -75.64838877 283.04037899 -74.4609375 297.11328125 C-75.58786314 301.13457573 -76.37647681 301.05713218 -79.86328125 303.0234375 C-82.42379365 304.85002736 -84.06792443 306.21756831 -84.89135742 309.32125854 C-85.55239975 314.48596655 -85.43527639 319.6637541 -85.27368164 324.85864258 C-85.18887131 327.64248777 -85.171212 330.42006939 -85.16601562 333.20507812 C-84.90024199 358.85466002 -77.37924788 386.28790818 -60.02807617 405.8972168 C-54.5743977 410.77258466 -45.19430626 411.28520428 -38.25 412.375 C-36.69369873 412.62491699 -36.69369873 412.62491699 -35.10595703 412.87988281 C-31.86428324 413.39231908 -28.62052544 413.88758394 -25.375 414.375 C-24.34246094 414.53033203 -23.30992187 414.68566406 -22.24609375 414.84570312 C-19.24936647 415.2877491 -16.2506885 415.71076523 -13.25 416.125 C-12.36425293 416.25261719 -11.47850586 416.38023437 -10.56591797 416.51171875 C-5.35991513 417.198267 -0.28142963 417.43267518 4.97216797 417.40722656 C6.22142059 417.40257385 7.47067322 417.39792114 8.75778198 417.39312744 C10.1770549 417.38415436 10.1770549 417.38415436 11.625 417.375 C11.6481435 405.04035432 11.66592537 392.70571378 11.67681217 380.37105083 C11.68203659 374.64392519 11.68912628 368.91681437 11.70043945 363.18969727 C11.71128394 357.66543748 11.71728017 352.14119198 11.71987724 346.61692238 C11.72172866 344.50654691 11.72534388 342.39617225 11.73073006 340.28580284 C11.73796116 337.33594431 11.73899006 334.38614523 11.73852539 331.4362793 C11.7439183 330.1199778 11.7439183 330.1199778 11.74942017 328.77708435 C11.74363022 325.39295366 11.70270423 322.60811268 10.625 319.375 C11.73875 319.54 12.8525 319.705 14 319.875 C27.4609318 321.31336306 40.48919056 320.36302786 53.75952148 317.97631836 C56.0839339 317.55864858 58.4113543 317.16340183 60.74023438 316.77148438 C68.83240422 315.38472334 76.75798186 313.76828285 84.625 311.375 C86.35015161 303.4505963 83.57546017 296.76375923 80.625 289.375 C79.81123885 287.25048263 78.99885034 285.12543922 78.1875 283 C77.33476678 280.79111275 76.48064014 278.58276284 75.625 276.375 C75.24859375 275.40046875 74.8721875 274.4259375 74.484375 273.421875 C74.13890625 272.54015625 73.7934375 271.6584375 73.4375 270.75 C73.13457031 269.97398437 72.83164062 269.19796875 72.51953125 268.3984375 C71.58655622 266.1321849 71.58655622 266.1321849 69.625 263.375 C63.52413776 261.94086317 57.23959461 262.24691127 51.00390625 262.27734375 C49.35405983 262.27946617 49.35405983 262.27946617 47.67088318 262.28163147 C44.17639383 262.28720497 40.68196981 262.29975261 37.1875 262.3125 C34.8105478 262.31751842 32.4335946 262.32208073 30.05664062 262.32617188 C24.24607166 262.33716572 18.4355405 262.35387738 12.625 262.375 C12.62076806 261.20694635 12.61653612 260.03889271 12.61217594 258.8354435 C12.51157948 231.13085845 12.40588544 203.42629669 12.29388306 175.7217553 C12.28011288 172.31450369 12.26638588 168.9072519 12.25268555 165.5 C12.24995724 164.82165507 12.24722894 164.14331014 12.24441796 163.4444093 C12.20029922 152.44944164 12.15968067 141.45446368 12.12034739 130.45947798 C12.07993375 119.18418893 12.03570363 107.90891927 11.98812145 96.63365781 C11.96150547 90.2977562 11.93665205 83.96185845 11.91592598 77.6259346 C11.89638432 71.66871428 11.87224802 65.71153066 11.84450912 59.75434303 C11.83512557 57.56211194 11.82745501 55.36987278 11.82158089 53.17762947 C11.81334183 50.19614799 11.79907143 47.21475613 11.78321838 44.23330688 C11.78224028 43.3558873 11.78126217 42.47846772 11.78025442 41.57445967 C11.87005708 37.34005873 11.87005708 37.34005873 10.625 33.375 C7.44832685 33.375 4.3887552 33.506187 1.2265625 33.7421875 Z M70 390.625 C68.31003906 391.00398438 68.31003906 391.00398438 66.5859375 391.390625 C63.68436229 392.35526478 62.33942693 392.87855377 60.625 395.375 C60.3746423 399.00035976 60.3746423 399.00035976 60.625 402.375 C62.54231918 402.26044319 64.4588675 402.13293742 66.375 402 C67.44234375 401.93039062 68.5096875 401.86078125 69.609375 401.7890625 C72.42706432 401.4021777 74.2080366 400.81813834 76.625 399.375 C76.625 398.715 76.625 398.055 76.625 397.375 C77.5840625 397.0346875 77.5840625 397.0346875 78.5625 396.6875 C80.89693661 395.52249104 80.89693661 395.52249104 81.375 392.75 C81.4575 391.96625 81.54 391.1825 81.625 390.375 C77.36583398 389.19455698 74.27683433 389.62215609 70 390.625 Z "
          fill="${color}"
          transform="translate(262.375,28.625)"
        />
      </svg>`)

    inputSetups.set("image_0", (/** @type HTMLElement */ imageInput) => {
      console.log(`imageInput found`)
			const img = document.createElement("div")
			img.innerHTML = images.get("chassis")
			// img.style.filter = "opacity(0.5) drop-shadow(0 0 0 blue) sepia(1) saturate(5);"
			imageInput.parentElement?.append(img)
      imageInput.addEventListener("change", (e) => {
        console.log("imageinput value changed")
        console.log(e.target)
      })
    })

    inputSetups.set("color_0", (/** @type HTMLElement */ colorInput) => {
      console.log(`color Input found: ${colorInput}`)
      if (colorInput instanceof HTMLInputElement) {
        colorInput.type = "color"
      }
    })

    function disconnectObserver(
      /** @type MutationObserver */ observerInstance,
    ) {
      if (inputSetups.size === 0) {
        observerInstance.disconnect()
        console.log("disconnected observer")
      }
    }

    function waitForInputs() {
      const observer = new MutationObserver((_, observerInstance) => {
        ;[...inputSetups.keys()].forEach((id) => {
          console.log(`observing id: ${id}`)
          const input = document.getElementById(id)
          const func = inputSetups.get(id)
          if (
            input &&
            (input instanceof HTMLSelectElement ||
              input instanceof HTMLInputElement) &&
            func
          ) {
            func(input)
            inputSetups.delete(id)
            disconnectObserver(observerInstance)
          }
        })
      })

      observer.observe(document.body, {
        childList: true,
        subtree: true,
      })
    }

    document.addEventListener("DOMContentLoaded", waitForInputs)
  },
)
